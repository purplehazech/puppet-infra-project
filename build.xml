<?xml version="1.0"?>
<project name="puppet-infra-project" default="test">

	<target name="test">
		<exec executable="puppet" failonerror="true">
			<arg value="apply"/>
			<arg value="--parseonly"/>
			<arg value="site.pp"/>
		</exec>
	</target>

    <target name="docs">
        <mkdir dir="build/"/>
        <mkdir dir="build/docs"/>
        <exec executable="find" failonerror="true">
            <arg value="."/>
            <arg value="-name"/>
            <arg value="README.md"/>
            <arg value="-exec"/>
            <arg value="markdown"/>
            <arg value="build/docs/{}.html"/>
            <arg value="{} \;"/>
        </exec>
    </target>

    <target name="deploy-local">
        <exec executable="sudo" failonerror="true">
            <arg value="/usr/sbin/jenkins-receive"/>
        </exec>
        <exec executable="sudo" failonerror="true">
            <arg value="/usr/sbin/puppet-apply"/>
        </exec>
    </target>

</project>
